{{ if .Vars.rhel8cis_level_1 }}
  {{ if .Vars.rhel8cis_rule_6_2_11 }}
command:
  dot_file_perms:
    title: 6.2.11 | Ensure local interactive user dot files access is configured
    exec: 'find /home/ -name "\.*" -perm /g+w,o+w'
    exit-status: 0
    stdout:
    - '!/./'
    meta:
      server: 1
      workstation: 1
      CIS_ID:
      - 6.2.11
      CISv8: 3.3
      CISv8_IG1: true
      CISv8_IG2: true
      CISv8_IG3: true
      NIST800-53R5:
      - CM-1
      - CM-2
      - CM-6
      - CM-7
      - IA-5
  bash_history_perms:
    title: 6.2.11 | Ensure local interactive user dot files access is configured | bash_history
    exec: 'find /home/ -name .bash_history -perm /go+rwx'
    exit-status: 0
    stdout:
    - '!/./'
    meta:
      server: 1
      workstation: 1
      CIS_ID:
      - 6.2.11
      CISv8: 3.3
      CISv8_IG1: true
      CISv8_IG2: true
      CISv8_IG3: true
      NIST800-53R5:
      - CM-1
      - CM-2
      - CM-6
      - CM-7
      - IA-5
  dot_files_that_should not exist:
    title: 6.2.11 | Ensure local interactive user dot files access is configured | dot files that should not exist
    exec: find /home/ \( -name '.netrc' -o -name '.forward' -o -name '.rhosts' \)
    exit-status: 0
    stdout:
    - '!/./'
    meta:
      server: 1
      workstation: 1
      CIS_ID:
      - 6.2.11
      CISv8: 3.3
      CISv8_IG1: true
      CISv8_IG2: true
      CISv8_IG3: true
      NIST800-53R5:
      - CM-1
      - CM-2
      - CM-6
      - CM-7
      - IA-5
  {{ end }}
{{ end }}
